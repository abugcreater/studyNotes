# 64 | 状态模式：游戏、工作流引擎中常用的状态机是如何实现的？

有限状态机(Finite State Machine,FSM),简称状态机.状态机有3 个组成部分：状态（State）、事件（Event）、动作（Action）。其中，事件也称为转移条件（Transition Condition）。事件触发状态的转移及动作的执行。不过，动作不是必须的，也可能只转移状态，不执行任何动作。



状态机实现方式:

第一种实现方式叫分支逻辑法。利用 if-else 或者 switch-case 分支逻辑，参照状态转移图，将每一个状态转移原模原样地直译成代码。对于简单的状态机来说，这种实现方式最简单、最直接，是首选。

第二种实现方式叫查表法。对于状态很多、状态转移比较复杂的状态机来说，查表法比较合适。通过二维数组来表示状态转移图，能极大地提高代码的可读性和可维护性。

![image-20210831143255551](C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20210831143255551.png)

维护当前的状态机变化,当有事件发生时直接获取对应维度的值内容.



第三种实现方式叫状态模式。对于状态并不多、状态转移也比较简单，但事件触发执行的动作包含的业务逻辑可能比较复杂的状态机来说，我们首选这种实现方式。

定义一个接口,每个事件都是一个抽象方法,每个实现类代表每个状态,每个抽象方法中都代表了该状态下事件发生时会产生的状态变化,和实现动作.



