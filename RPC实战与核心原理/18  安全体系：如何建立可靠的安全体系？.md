# 18 | 安全体系：如何建立可靠的安全体系？

### 为什么需要考虑安全问题？

RPC应用一般部署在内网中,相对公网来说比较安全,很少有数据包篡改等安全问题.

但是,在部分场景中会出现,调用方直接引入提供方的接口,不通过注册直接调用.如果这个调用方,调用量很大,可能会导致服务提供方崩溃.

### 调用方之间的安全保证

解决方案:调用方在调用之前向服务提供方登记身份,在调用时验证.

**如何实现？**

集中式认证新增授权平台,提供调用方登记.

![image-20220114150312848](C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20220114150312848.png)

缺点:当公司内部 RPC 使用程度高了之后，这个授权平台就会成为一个瓶颈点，而且必须保证超高可用，一旦这个授权平台出现问题，影响的可就是全公司的 RPC 请求了。

**更优雅一点的方案**

在调用方启动初始化接口的时候，带上授权平台上颁发的身份去服务提供方认证下，当认证通过后就认为这个接口可以调用。并且服务提供方在改平台发放用于 HMAC 签名的私钥,调用接口时比对私钥即可.

### 服务发现也有安全问题？

伪造服务提供方,导致一系列安全问题.

服务提供方启动的时候，需要把接口实例在注册中心进行注册登记。我们就可以利用这个流程，注册中心可以在收到服务提供方注册请求的时候，验证下请求过来的应用是否跟接口绑定的应用一样，只有相同才允许注册，否则就返回错误信息给启动的应用，从而避免假冒的服务提供者对外提供错误服务。