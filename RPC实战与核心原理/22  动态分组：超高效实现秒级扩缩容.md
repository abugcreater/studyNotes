# 22 | 动态分组：超高效实现秒级扩缩容

### 分组后容量评估

如何合并调用方到同一个分组?

按照调用方的重要级别,让非核心业务应用跟核心业务应用不要公用一个分组，核心应用之间也最好别用同一个分组。

如何设计分组容量?

我们一般会先通过压测去评估下服务提供方单台机器所能承受的 QPS，然后再计算出每个分组里面的所有调用方的调用总量。有了这两个值之后，我们就能很容易地计算出这个分组所需要的机器数。防止突发流量需要在此基础上加个百分比,额外预留一些机器.

### 分组带来的问题

当遇到大的突发流量时,临时扩容需要较长时间,该怎么解决?

可以利用其他分组多于的机器,这时动态分组就可以派上用处了

### 动态分组的应用

利用注册中心中服务发现的数据,把部分实例的别名改成想要的别名,通过服务发现进而影响到不同调用方能够调用的服务提供方实例集合.

![image-20220116214951481](C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20220116214951481.png)

通过直接修改注册中心数据，我们可以让任何一个分组瞬间拥有不同规模的集群能力。我们不仅可以实现把某个实例的分组名改成另外一个分组名，还可以让某个实例分组名变成多个分组名，这就是我们在动态分组里面最常见的两种动作——追加和替换。



没有必要把所有冗余的机器都分配到分组里面，我们可以把这些预留的机器做成一个共享的池子，从而减少整体预留的实例数量。



